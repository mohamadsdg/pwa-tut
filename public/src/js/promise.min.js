window.setImmediate||function(){"use strict";var i=0,o={},u=!0,c=Array.prototype.slice,f="setImmediatePolyfillMessage";function a(n){var e,n=n.data;if("string"==typeof n&&0==n.indexOf(f)&&(e=o[n])){delete o[n];var t=e,r=t[0];switch(t.length){case 1:return void r();case 2:return void r(t[1]);case 3:return void r(t[1],t[2])}r.apply(window,c.call(t,1))}}window.setImmediate=function(){for(var n=i++,e=f+n,t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return o[e]=r,u&&(u=!1,window.addEventListener("message",a)),window.postMessage(e,"*"),n},window.clearImmediate=function(n){delete o[f+n]}}(),function(n){"use strict";var d="[[PromiseStatus]]",h="[[PromiseValue]]",w="[[OnFulfilled]]",m="[[OnRejected]]",a="[[OriginalError]]",i="pending",o="internal pending",v="fulfilled",y="rejected",g="not an array.",t='constructor Promise requires "new".',P=n.setImmediate||require("timers").setImmediate,j=Array.isArray||function(n){return"[object Array]"==Object.prototype.toString.call(n)};function u(n){this[a]=n}function s(n){return n instanceof u}function c(n){return"function"==typeof n}function l(n){return n instanceof e}function r(n){return n}function E(n){throw n}function f(n){delete n[w],delete n[m]}function I(n){for(var e=n.length,t=0;t<e;t++)n[t]()}function O(n,e,t){var r=p(t);l(r)?r.then(n,e):s(r)?e(r[a]):n(t)}function p(t){var r,n;if(l(t))return t;if(n=t,Object(n)===n){try{r=t.then}catch(n){return new u(n)}if(c(r))return new e(function(n,e){P(function(){try{r.call(t,n,e)}catch(n){e(n)}})})}return null}function b(e,n){function t(n){e[d]==i&&!function e(t,n){var r=p(n);l(r)?(t[d]=o,r.then(function(n){e(t,n)},function(n){A(t,n)})):s(r)?A(t,r[a]):(t[d]=v,t[h]=n,(r=t[w])&&r.length&&(f(t),I(r)))}(e,n)}function r(n){e[d]==i&&A(e,n)}try{n(t,r)}catch(n){r(n)}}function A(n,e){var t=n[m];n[d]=y,n[h]=e,t&&t.length&&(f(n),I(t))}function e(n){if(!l(this))throw new TypeError(t);this[d]=i,this[h]=void 0,b(this,n)}e.prototype.then=function(f,a){var s,l=this;return f=c(f)?f:r,a=c(a)?a:E,s=new e(function(t,r){function n(n){var e;try{e=n(l[h])}catch(n){return void r(n)}e===s?r(new TypeError("then() cannot return same Promise that it resolves.")):O(t,r,e)}function e(){P(n,f)}function i(){P(n,a)}switch(l[d]){case v:e();break;case y:i();break;default:u=e,c=i,(o=l)[w]||(o[w]=[],o[m]=[]),o[w].push(u),o[m].push(c)}var o,u,c})},e.prototype.catch=function(n){return this.then(r,n)},e.resolve=function(t){var r=p(t);return l(r)?r:new e(function(n,e){s(r)?e(r[a]):n(t)})},e.reject=function(t){return new e(function(n,e){e(t)})},e.race=function(i){return new e(function(n,e){var t,r;if(j(i))for(r=i.length,t=0;t<r;t++)O(n,e,i[t]);else e(new TypeError(g))})},e.all=function(f){return new e(function(t,n){var e,r,i,o,u=0,c=0;if(j(f)){for(r=(f=f.slice(0)).length,o=0;o<r;o++)l(e=p(i=f[o]))?(c++,e.then(function(e){return function(n){f[e]=n,++u==c&&t(f)}}(o),n)):s(e)?n(e[a]):f[o]=i;c||t(f)}else n(new TypeError(g))})},"undefined"!=typeof module&&module.exports?module.exports=n.Promise||e:n.Promise||(n.Promise=e)}(this);